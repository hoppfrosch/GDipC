if(!String.prototype.startsWith){String.prototype.startsWith=function(searchString,position){position=position||0;return(this.substr(position,searchString.length)==searchString);};}if(!Function.prototype.bind){Function.prototype.bind=function(oThis){var aArgs=Array.prototype.slice.call(arguments,1);var fToBind=this;var fNOP=function(){};var fBound=function(){return fToBind.apply(this instanceof fNOP?this:oThis,aArgs.concat(Array.prototype.slice.call(arguments)));};if(this.prototype){fNOP.prototype=this.prototype;}fBound.prototype=new fNOP();return fBound;};}var NDWShared=new function(){this.OnLoad=function(){var supportsCalc=false;try{var testDiv=document.createElement("div");testDiv.style.width="10px";testDiv.style.width="calc(10px + 10px)";testDiv.style.height="0";document.body.appendChild(testDiv);supportsCalc=(testDiv.clientWidth==20);document.body.removeChild(testDiv);}catch(e){supportsCalc=false;}if(!supportsCalc){this.AddClass(document.body,"NoCSSCalc");}var supportsSVG=(typeof SVGRect!="undefined");if(!supportsSVG){this.AddClass(document.body,"NoSVG");this.ConvertSVGToPNG();}};this.HasClass=function(element,targetClassName){if(element.className==undefined){return false;}var index=element.className.indexOf(targetClassName);if(index!=-1){if((index==0||element.className.charAt(index-1)==' ')&&(index+targetClassName.length==element.className.length||element.className.charAt(index+targetClassName.length)==' ')){return true;}}return false;};this.AddClass=function(element,newClassName){if(element.className==undefined){element.className=newClassName;return;}var index=element.className.indexOf(newClassName);if(index!=-1){if((index==0||element.className.charAt(index-1)==' ')&&(index+newClassName.length==element.className.length||element.className.charAt(index+newClassName.length)==' ')){return;}}if(element.className.length==0){element.className=newClassName;}else{element.className+=" "+newClassName;}};this.RemoveClass=function(element,targetClassName){if(element.className==undefined){return;}var index=element.className.indexOf(targetClassName);while(index!=-1){if((index==0||element.className.charAt(index-1)==' ')&&(index+targetClassName.length==element.className.length||element.className.charAt(index+targetClassName.length)==' ')){var newClassName="";if(index>0){newClassName+=element.className.substr(0,index);}if(index+targetClassName.length!=element.className.length){newClassName+=element.className.substr(index+targetClassName.length);}element.className=newClassName;return;}index=element.className.indexOf(targetClassName,index+1);}};this.GetElementsByClassName=function(baseElement,className,tagHint){if(baseElement.getElementsByClassName){return baseElement.getElementsByClassName(className);}if(!tagHint){tagHint="*";}var tagArray=baseElement.getElementsByTagName(tagHint);var matchArray=new Array();var tagIndex=0;var matchIndex=0;while(tagIndex<tagArray.length){if(this.HasClass(tagArray[tagIndex],className)){matchArray[matchIndex]=tagArray[tagIndex];matchIndex++;}tagIndex++;}return matchArray;};this.AddEventListener=function(element,event,eventHandler){if(element.attachEvent){return element.attachEvent("on"+event,eventHandler);}else{return element.addEventListener(event,eventHandler);}};this.OffsetTopFromBody=function(element){var result=element.offsetTop;element=element.offsetParent;while(element!=undefined&&element.nodeName!="BODY"){result+=element.offsetTop;element=element.offsetParent;}return result;};this.OffsetLeftFromBody=function(element){var result=element.offsetLeft;element=element.offsetParent;while(element!=undefined&&element.nodeName!="BODY"){result+=element.offsetLeft;element=element.offsetParent;}return result;};this.ScrollTOCIntoView=function(){var sideMenuPanelCollection=this.GetElementsByClassName(document,"SideMenuPanel","div");if(sideMenuPanelCollection.length==0){return;}var sideMenuPanel=sideMenuPanelCollection[0];if(window.getComputedStyle==undefined||window.getComputedStyle(sideMenuPanel).position!="fixed"){return;}var selectedTOCEntryCollection=this.GetElementsByClassName(sideMenuPanel,"TOCEntry Selected","div");if(selectedTOCEntryCollection.length==0){return;}var selectedTOCEntry=selectedTOCEntryCollection[0];var tocEntryChildren=this.GetElementsByClassName(sideMenuPanel,"TOCEntry Child","div");if(tocEntryChildren.length>0){tocEntryChildren[tocEntryChildren.length-1].scrollIntoView(false);if(sideMenuPanel.scrollTop>selectedTOCEntry.offsetTop){selectedTOCEntry.scrollIntoView(true);}}else{selectedTOCEntry.scrollIntoView(false);}};this.ConvertSVGToPNG=function(){var svgImages=this.GetElementsByClassName(document,"SVGPNG","img");for(var i=0;i<svgImages.length;i++){var oldSrc=svgImages[i].src;var newSrc=oldSrc.substr(0,oldSrc.length-3)+"png";svgImages[i].src=newSrc;}};};var NDWSiteMenu=new function(){this.OnLoad=function(){this.openSubMenuOffsets=[];this.isFrontPage=NDWShared.HasClass(document.body,"FrontPage");this.headerElement=document.getElementById("SiteHeader");this.logoElement=document.getElementById("SiteLogo");this.menuContainer=document.getElementById("SiteMenu");if(this.isFrontPage){this.embeddedMenuContainer=document.getElementById("EmbeddedMenuContainer");this.logoBlockElement=document.getElementById("LogoBlock");}this.SetMenuMode();NDWShared.AddEventListener(document,"click",this.OnClick.bind(this));NDWShared.AddEventListener(document,"keydown",this.OnKeyDown.bind(this));NDWShared.AddEventListener(window,"resize",this.OnResize.bind(this));if(this.isFrontPage){NDWShared.AddEventListener(window,"scroll",this.OnScroll.bind(this));}};this.OnClick=function(event){if(this.openSubMenuOffsets.length==0){return;}if(event===undefined){event=window.event;}if(!this.menuContainer.contains(event.target)){this.Close();}};this.OnKeyDown=function(event){if(this.openSubMenuOffsets.length==0){return;}if(event===undefined){event=window.event;}if(event.keyCode==27){this.Close();}};this.OnResize=function(){this.Close();this.SetMenuMode();this.SetSiteHeaderSpacer();};this.OnScroll=function(){this.SetMenuMode();};this.SetMenuMode=function(){var firstRun=false;if(this.menuMode===undefined){firstRun=true;this.headerElement.style.visibility="hidden";NDWShared.AddClass(this.headerElement,"Wide");this.menuMode=1;this.BuildTopLevelMenu();this.wideMenuWidth=this.menuContainer.clientWidth;this.floatingHeaderHeight=this.headerElement.clientHeight;if(this.isFrontPage){NDWShared.RemoveClass(this.headerElement,"Wide");NDWShared.AddClass(this.headerElement,"Embedded");this.menuMode=3;this.BuildTopLevelMenu();this.embeddedMenuHeight=this.menuContainer.clientHeight;}}if(this.isFrontPage){if(this.menuMode==3&&window.pageYOffset>=this.logoBlockElement.clientHeight+this.embeddedMenuHeight-this.floatingHeaderHeight){NDWShared.RemoveClass(this.headerElement,"Embedded");NDWShared.AddClass(this.headerElement,"Wide");this.menuMode=1;this.BuildTopLevelMenu();if(!firstRun){NDWShared.AddClass(this.headerElement,"FadeIn");}}else if(this.menuMode!=3&&window.pageYOffset<this.logoBlockElement.clientHeight+this.embeddedMenuHeight-this.floatingHeaderHeight){NDWShared.RemoveClass(this.headerElement,"Wide");NDWShared.RemoveClass(this.headerElement,"Narrow");NDWShared.AddClass(this.headerElement,"Embedded");this.menuMode=3;NDWShared.RemoveClass(this.headerElement,"FadeIn");this.BuildTopLevelMenu();}}if(this.menuMode==1&&this.headerElement.clientWidth-this.logoElement.clientWidth<this.wideMenuWidth){this.menuMode=2;this.BuildTopLevelMenu();}else if(this.menuMode==2&&this.headerElement.clientWidth-this.logoElement.clientWidth>=this.wideMenuWidth){this.menuMode=1;this.BuildTopLevelMenu();}if(this.menuMode==2){var icon=document.getElementById("SiteMenuIcon");var height=this.headerElement.clientHeight;icon.style.height=height+"px";icon.style.width=(this.menuIconWidth*(height/this.menuIconHeight))+"px";this.floatingHeaderHeight=this.headerElement.clientHeight;}if(firstRun){this.headerElement.style.visibility="visible";}};this.SetSiteHeaderSpacer=function(){document.getElementById("SiteHeaderSpacer").style.height=this.headerElement.clientHeight+"px";};this.BuildTopLevelMenu=function(){this.Close();var newMenuContainer=document.createElement("div");newMenuContainer.id="SiteMenu";if(this.menuMode==1){newMenuContainer.className="Wide";}else if(this.menuMode==2){newMenuContainer.className="Narrow";}else{newMenuContainer.className="Embedded";}this.BuildMenuItems(newMenuContainer,[]);this.headerElement.replaceChild(newMenuContainer,this.menuContainer);this.menuContainer=newMenuContainer;if(this.menuMode==2&&this.menuIconWidth==undefined){var icon=document.getElementById("SiteMenuIcon");this.menuIconWidth=icon.clientWidth;this.menuIconHeight=icon.clientHeight;}};this.BuildMenuItems=function(container,offsets){var menuItemsToBuild;if(this.menuMode==1){menuItemsToBuild=this.wideMenuItems;}else if(this.menuMode==2){menuItemsToBuild=this.narrowMenuItems;}else{menuItemsToBuild=this.embeddedMenuItems;}for(var i=0;i<offsets.length;i++){menuItemsToBuild=menuItemsToBuild[offsets[i]][1];}for(var i=0;i<menuItemsToBuild.length;i++){var menuItemID="SMItem";if(offsets.length>0){menuItemID+="-"+offsets.join("-");}menuItemID+="-"+i;var menuItemElement=document.createElement("div");menuItemElement.className="SMItem";menuItemElement.id=menuItemID;var menuItemHRef,menuItemTarget;if(typeof(menuItemsToBuild[i][1])=="object"){menuItemHRef="javascript:NDWSiteMenu.Select([";if(offsets!=undefined){for(var o=0;o<offsets.length;o++){menuItemHRef+=offsets[o]+",";}}menuItemHRef+=i+"]);";menuItemTarget=undefined;}else if(menuItemsToBuild[i][1].startsWith("http")){menuItemHRef=menuItemsToBuild[i][1];menuItemTarget="_blank";}else{menuItemHRef=menuItemsToBuild[i][1];menuItemTarget=undefined;}var menuItemLink=document.createElement("a");menuItemLink.className="SMItemTitle";menuItemLink.href=menuItemHRef;menuItemLink.innerHTML=menuItemsToBuild[i][0];if(menuItemTarget!=undefined){menuItemLink.target=menuItemTarget;}menuItemElement.appendChild(menuItemLink);container.appendChild(menuItemElement);}};this.Select=function(newOffsets){var endOfMatches=0;while(endOfMatches<this.openSubMenuOffsets.length&&endOfMatches<newOffsets.length&&this.openSubMenuOffsets[endOfMatches]==newOffsets[endOfMatches]){endOfMatches++;}if(endOfMatches==newOffsets.length&&endOfMatches>0){while(this.openSubMenuOffsets.length>newOffsets.length-1){this.CloseSubMenu(this.openSubMenuOffsets);this.openSubMenuOffsets.pop();}}else{while(this.openSubMenuOffsets.length>endOfMatches){this.CloseSubMenu(this.openSubMenuOffsets);this.openSubMenuOffsets.pop();}while(this.openSubMenuOffsets.length<newOffsets.length){this.openSubMenuOffsets.push(newOffsets[this.openSubMenuOffsets.length]);this.OpenSubMenu(this.openSubMenuOffsets);}}};this.Close=function(){if(this.openSubMenuOffsets.length>0){this.Select([this.openSubMenuOffsets[0]]);}};this.OpenSubMenu=function(offsets){var offsetsString=offsets.join("-");var parentMenuItem=document.getElementById("SMItem-"+offsetsString);NDWShared.AddClass(parentMenuItem,"Open");var subMenuContainer=document.createElement("div");subMenuContainer.className="SMSubMenu";subMenuContainer.id="SMSubMenu-"+offsetsString;this.BuildMenuItems(subMenuContainer,offsets);this.menuContainer.appendChild(subMenuContainer);var top=NDWShared.OffsetTopFromBody(parentMenuItem);var left=NDWShared.OffsetLeftFromBody(parentMenuItem);if(this.menuMode==2){if(offsets.length==1){subMenuContainer.style.minWidth=(parentMenuItem.clientWidth+35)+"px";top+=parentMenuItem.clientHeight;left=left-subMenuContainer.clientWidth+parentMenuItem.clientWidth;}else{left-=subMenuContainer.clientWidth+3;}}else{top+=parentMenuItem.clientHeight;var minWidth=parentMenuItem.clientWidth;if(offsets.length>1){left+=35;}else{minWidth+=35;}subMenuContainer.style.minWidth=minWidth+"px";}var width=subMenuContainer.clientWidth;var windowWidth=document.body.clientWidth;if(left+width>windowWidth){left=windowWidth-width;}if(left<0){left=0;}subMenuContainer.style.top=top+"px";subMenuContainer.style.left=left+"px";};this.CloseSubMenu=function(offsets){var offsetsString=offsets.join("-");var subMenuContainer=document.getElementById("SMSubMenu-"+offsetsString);subMenuContainer.parentElement.removeChild(subMenuContainer);var parentMenuItem=document.getElementById("SMItem-"+offsetsString);NDWShared.RemoveClass(parentMenuItem,"Open");};this.wideMenuItems=NDWSiteMenuContent;this.narrowMenuItems=[["<div id=\"SiteMenuIcon\"></div>",this.wideMenuItems]];this.embeddedMenuItems=this.wideMenuItems.slice(0,this.wideMenuItems.length-1);};